{% extends "base/base.html" %}
{% load static %}

{% block title %}Query SQL – RNI{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/query.css' %}">
{% endblock %}

{% block content %}
<div class="query-container">

  <div class="query-card">

    <h1>Consulta SQL – PostgreSQL</h1>

    <form method="post">
      {% csrf_token %}

      <textarea
        name="query"
        placeholder="SELECT * FROM colaborador LIMIT 10;"
        required
      >{{ query }}</textarea>

      <div class="actions">
        <button type="submit">Consultar</button>
      </div>
    </form>

    {% if error %}
      <div class="error">
        <strong>Error:</strong> {{ error }}
      </div>
    {% endif %}

    {% if rows %}
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              {% for col in columns %}
                <th>{{ col }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            {% for row in rows %}
              <tr>
                {% for cell in row %}
                  <td>{{ cell }}</td>
                {% endfor %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% endif %}

    <div class="back-link">
      <a href="{% url 'home' %}">← Volver al inicio</a>
    </div>

  </div>

</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/query.js' %}"></script>
{% endblock %}
